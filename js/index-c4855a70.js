import{y as O,ao as Ce,ad as ae,M as le,z as be,d as T,P as Y,h as B,A as E,aj as we,R as se,D as Ee,o as v,c as N,Y as F,u as t,I as w,j as o,W as ne,N as W,m as q,n as z,_ as J,Z,ap as X,aq as Ve,Q as Se,e as x,k as M,g as _,t as S,i as e,T as Te,a0 as Be,a8 as R,a7 as ze,r as H,a as Ne,a3 as ee,f as xe,F as Pe,b as $e,ak as Ie,ai as Ue}from"./index-a1d665fd.js";import{E as Le}from"./el-overlay-04926d79.js";import{E as Ae,a as je,b as Re}from"./el-form-item-d391bbce.js";import{E as De,a as Fe}from"./el-select-eeb7016c.js";import{a as te,b as He}from"./el-scrollbar-866c2499.js";import{E as Me}from"./el-upload-60adf426.js";/* empty css                */import{E as Ke,_ as Oe}from"./index-f5b762d2.js";import{b as oe,E as K}from"./el-button-a92acdba.js";import"./el-checkbox-2b948046.js";import{h as D}from"./index-7d59f0d6.js";import{u as L}from"./useValidate-edbff549.js";import{C as re}from"./event-9519ab40.js";import"./refs-9252dcf9.js";import"./use-form-item-bfe1468d.js";import"./error-78e43d3e.js";import"./baseClone-77b8d394.js";import"./Uint8Array-7ff40316.js";import"./isNil-c75b1b34.js";import"./isEqual-d8259db3.js";import"./plugin-vueexport-helper-c27b6911.js";const Ye=O({size:{type:[Number,String],values:Ce,default:"",validator:l=>ae(l)},shape:{type:String,values:["circle","square"],default:"circle"},icon:{type:le},src:{type:String,default:""},alt:String,srcSet:String,fit:{type:be(String),default:"cover"}}),We={error:l=>l instanceof Event},qe=["src","alt","srcset"],Je=T({name:"ElAvatar"}),Ze=T({...Je,props:Ye,emits:We,setup(l,{emit:y}){const h=l,u=Y("avatar"),d=B(!1),i=E(()=>{const{size:s,icon:V,shape:P}=h,a=[u.b()];return we(s)&&a.push(u.m(s)),V&&a.push(u.m("icon")),P&&a.push(u.m(P)),a}),m=E(()=>{const{size:s}=h;return ae(s)?u.cssVarBlock({size:se(s)||""}):void 0}),c=E(()=>({objectFit:h.fit}));Ee(()=>h.src,()=>d.value=!1);function A(s){d.value=!0,y("error",s)}return(s,V)=>(v(),N("span",{class:z(t(i)),style:F(t(m))},[(s.src||s.srcSet)&&!d.value?(v(),N("img",{key:0,src:s.src,alt:s.alt,srcset:s.srcSet,style:F(t(c)),onError:A},null,44,qe)):s.icon?(v(),w(t(W),{key:1},{default:o(()=>[(v(),w(ne(s.icon)))]),_:1})):q(s.$slots,"default",{key:2})],6))}});var Ge=J(Ze,[["__file","/home/runner/work/element-plus/element-plus/packages/components/avatar/src/avatar.vue"]]);const Qe=Z(Ge),Xe=O({checked:{type:Boolean,default:!1}}),et={"update:checked":l=>X(l),[re]:l=>X(l)},tt=T({name:"ElCheckTag"}),ot=T({...tt,props:Xe,emits:et,setup(l,{emit:y}){const h=l,u=Y("check-tag"),d=E(()=>[u.b(),u.is("checked",h.checked)]),i=()=>{const m=!h.checked;y(re,m),y("update:checked",m)};return(m,c)=>(v(),N("span",{class:z(t(d)),onClick:i},[q(m.$slots,"default")],2))}});var at=J(ot,[["__file","/home/runner/work/element-plus/element-plus/packages/components/check-tag/src/check-tag.vue"]]);const lt=Z(at),st=O({title:String,confirmButtonText:String,cancelButtonText:String,confirmButtonType:{type:String,values:oe,default:"primary"},cancelButtonType:{type:String,values:oe,default:"text"},icon:{type:le,default:()=>Ve},iconColor:{type:String,default:"#f90"},hideIcon:{type:Boolean,default:!1},hideAfter:{type:Number,default:200},teleported:te.teleported,persistent:te.persistent,width:{type:[String,Number],default:150}}),nt={confirm:l=>l instanceof MouseEvent,cancel:l=>l instanceof MouseEvent},rt=T({name:"ElPopconfirm"}),it=T({...rt,props:st,emits:nt,setup(l,{emit:y}){const h=l,{t:u}=Se(),d=Y("popconfirm"),i=B(),m=()=>{var a,j;(j=(a=i.value)==null?void 0:a.onClose)==null||j.call(a)},c=E(()=>({width:se(h.width)})),A=a=>{y("confirm",a),m()},s=a=>{y("cancel",a),m()},V=E(()=>h.confirmButtonText||u("el.popconfirm.confirmButtonText")),P=E(()=>h.cancelButtonText||u("el.popconfirm.cancelButtonText"));return(a,j)=>(v(),w(t(He),Te({ref_key:"tooltipRef",ref:i,trigger:"click",effect:"light"},a.$attrs,{"popper-class":`${t(d).namespace.value}-popover`,"popper-style":t(c),teleported:a.teleported,"fallback-placements":["bottom","top","right","left"],"hide-after":a.hideAfter,persistent:a.persistent}),{content:o(()=>[x("div",{class:z(t(d).b())},[x("div",{class:z(t(d).e("main"))},[!a.hideIcon&&a.icon?(v(),w(t(W),{key:0,class:z(t(d).e("icon")),style:F({color:a.iconColor})},{default:o(()=>[(v(),w(ne(a.icon)))]),_:1},8,["class","style"])):M("v-if",!0),_(" "+S(a.title),1)],2),x("div",{class:z(t(d).e("action"))},[e(t(K),{size:"small",type:a.cancelButtonType==="text"?"":a.cancelButtonType,text:a.cancelButtonType==="text",onClick:s},{default:o(()=>[_(S(t(P)),1)]),_:1},8,["type","text"]),e(t(K),{size:"small",type:a.confirmButtonType==="text"?"":a.confirmButtonType,text:a.confirmButtonType==="text",onClick:A},{default:o(()=>[_(S(t(V)),1)]),_:1},8,["type","text"])],2)],2)]),default:o(()=>[a.$slots.reference?q(a.$slots,"reference",{key:0}):M("v-if",!0)]),_:3},16,["popper-class","popper-style","teleported","hide-after","persistent"]))}});var ct=J(it,[["__file","/home/runner/work/element-plus/element-plus/packages/components/popconfirm/src/popconfirm.vue"]]);const pt=Z(ct),ut=Be("copy",!0,function(l){return e("svg",{width:l.size,height:l.size,viewBox:"0 0 48 48",fill:"none"},[e("path",{d:"M13 12.4316V7.8125C13 6.2592 14.2592 5 15.8125 5H40.1875C41.7408 5 43 6.2592 43 7.8125V32.1875C43 33.7408 41.7408 35 40.1875 35H35.5163",stroke:l.colors[0],"stroke-width":l.strokeWidth,"stroke-linecap":l.strokeLinecap,"stroke-linejoin":l.strokeLinejoin},null),e("path",{d:"M32.1875 13H7.8125C6.2592 13 5 14.2592 5 15.8125V40.1875C5 41.7408 6.2592 43 7.8125 43H32.1875C33.7408 43 35 41.7408 35 40.1875V15.8125C35 14.2592 33.7408 13 32.1875 13Z",fill:l.colors[1],stroke:l.colors[0],"stroke-width":l.strokeWidth,"stroke-linejoin":l.strokeLinejoin},null)])});const dt=T({__name:"index",props:{value:{default:"copy"},size:{default:"md"}},setup(l){const y=l,h=E(()=>{switch(y.size){case"mini":return 16;case"small":return 18;case"md":return 20;case"large":return 22;default:return 16}}),u=E(()=>{switch(y.size){case"mini":return"25px";case"small":return"30px";case"md":return"35px";case"large":return"40px"}}),d=()=>{try{navigator.clipboard.writeText(y.value).then(()=>R.success("复制成功"))}catch{const m=document.createElement("input");m.value=y.value,document.body.appendChild(m),m.select(),document.execCommand("Copy"),document.body.removeChild(m),R.success("复制成功")}};return(i,m)=>(v(),N("div",{class:z([{"h-[25px]":i.size=="mini","h-[30px]":i.size=="small","h-[35px]":i.size=="md","h-[40px]":i.size=="large"},"flex flex-row items-center justify-center flex-nowrapm-auto rounded w-full shadow overflow-hidden cursor-pointer"])},[x("div",{style:F({lineHeight:t(u)}),class:"indent-3 text-center text-white flex-1 h-full overflow-hidden text-ellipsis whitespace-nowrap bg-teal-500"},S(i.value),5),x("div",{onClick:d,class:"bg-teal-600 p-1 w-8 h-full flex items-center justify-center"},[e(t(ut),{theme:"outline",size:t(h),fill:"#fff"},null,8,["size"])])],2))}}),mt={class:"w-full h-full"},ft=["src"],ht={class:"cursor-pointer hover:text-primary"},vt={class:"dialog-footer"},jt=T({__name:"index",setup(l){const y=ze().token,h=B([]),u=B("/api/users"),d=B(),i=B(!1),m=B(),c=H({email:"",username:"",address:"",avatar:"",password:"",roleId:""}),A=H({username:L.pleaseInput,address:L.pleaseInput,avatar:L.pleaseSelect,email:L.email,password:L.password,roleId:L.pleaseSelect}),s=H({showName:"",uploadUrl:"http://localhost:2333/api/upload",fileList:[]}),V=()=>{var f;return(f=m.value)==null?void 0:f.getList()},P=()=>{d.value.validate(f=>{if(f){const r=JSON.parse(JSON.stringify(c));s.showName=="add"&&D.post(u.value,r).then(g=>{const{code:k,message:C}=g;k===200&&(R.success(C),i.value=!1,V())}),s.showName=="edit"&&(delete r.password,D.put(u.value,r).then(g=>{const{code:k,message:C}=g;k===200&&(R.success(C),i.value=!1,V())}))}})},a=()=>{D.get("/api/role").then(f=>{const{code:r,data:g}=f;r===200&&(h.value=g)})},j=f=>{D.post(u.value+"/resetPwd",{userId:f}).then(r=>{const{code:g,message:k}=r;g===200&&(R.success(k),V())})},ie=()=>{s.showName="add",i.value=!0,G(),a()},G=()=>{s.fileList=[],Object.keys(c).forEach(f=>c[f]="")},ce=f=>{Object.keys(f).forEach(r=>c[r]=f[r]),f.avatar&&(s.fileList=[{url:f.avatar,name:f.avatar}]),s.showName="edit",a(),i.value=!0};return(f,r)=>{const g=Ae,k=je,C=K,b=Ke,pe=dt,ue=Qe,Q=lt,de=pt,me=Oe,fe=W,he=Me,ve=De,_e=Fe,ye=Re,ge=Le,ke=Ne("copy");return v(),N("main",mt,[e(me,{ref_key:"CURDRef",ref:m,api:t(u),queryParam:{orderBy:"createdAt",orderSort:"asc"}},{search:o(({query:n,getList:$})=>[e(k,null,{default:o(()=>[e(g,{style:{width:"200px"},onKeyup:ee($,["enter"]),placeholder:"用户名",modelValue:n.username,"onUpdate:modelValue":I=>n.username=I,clearable:""},null,8,["onKeyup","modelValue","onUpdate:modelValue"])]),_:2},1024),e(k,null,{default:o(()=>[e(g,{style:{width:"200px"},onKeyup:ee($,["enter"]),placeholder:"邮箱",modelValue:n.email,"onUpdate:modelValue":I=>n.email=I,clearable:""},null,8,["onKeyup","modelValue","onUpdate:modelValue"])]),_:2},1024)]),buttons:o(({tableCheck:n,handleDelete:$})=>[e(C,{plain:"",type:"primary",onClick:ie},{default:o(()=>[_("新增")]),_:1}),e(C,{plain:"",type:"danger",disabled:n.length==0,onClick:I=>$()},{default:o(()=>[_("删 除")]),_:2},1032,["disabled","onClick"])]),table:o(({handleDelete:n,viewImg:$,errorImg:I})=>[e(b,{type:"index",align:"center",label:"序号",width:"70"}),e(b,{type:"selection",align:"center",width:"55"}),e(b,{"show-overflow-tooltip":"",align:"center",prop:"id",label:"id"},{default:o(({row:p})=>[e(pe,{value:p.id,size:"mini"},null,8,["value"])]),_:1}),e(b,{"show-overflow-tooltip":"",align:"center",prop:"username",label:"用户名"}),e(b,{"show-overflow-tooltip":"",align:"center",prop:"avatar",label:"头像"},{default:o(({row:p})=>[e(ue,{class:"cursor-pointer",shape:"square",fit:"cover",size:40,src:p.avatar,onClick:U=>$({url:p.avatar}),onError:()=>!0},{default:o(()=>[x("img",{src:I},null,8,ft)]),_:2},1032,["src","onClick"])]),_:2},1024),e(b,{"show-overflow-tooltip":"",align:"center",prop:"email",label:"邮箱"},{default:o(({row:p})=>[xe((v(),N("span",ht,[_(S(p.email),1)])),[[ke,p.email]])]),_:1}),e(b,{"show-overflow-tooltip":"",align:"center",label:"注册时间"},{default:o(({row:p})=>[_(S(f.dayjs(p.createdAt).format("YYYY-MM-DD HH:mm:ss")),1)]),_:1}),e(b,{"show-overflow-tooltip":"",align:"center",prop:"address",label:"地址"}),e(b,{"show-overflow-tooltip":"",align:"center",prop:"roleId",label:"角色"},{default:o(({row:p})=>[p.roles.length>0&&p.roles[0].key=="admin"?(v(),w(Q,{key:0,checked:""},{default:o(()=>[_(S(p.roles[0].name),1)]),_:2},1024)):(v(),w(Q,{key:1,class:"ml-2",checked:!1},{default:o(()=>{var U;return[_(S((U=p==null?void 0:p.roles[0])==null?void 0:U.name),1)]}),_:2},1024))]),_:1}),e(b,{fixed:"right",label:"操作",align:"center",width:"200"},{default:o(({row:p})=>[e(C,{onClick:U=>n(p.id),link:"",type:"danger"},{default:o(()=>[_("删除")]),_:2},1032,["onClick"]),e(C,{onClick:U=>ce(p),link:"",type:"warning"},{default:o(()=>[_("编辑")]),_:2},1032,["onClick"]),e(de,{"icon-color":"#626AEF",title:"确认重置密码?",onConfirm:U=>j(p.id)},{reference:o(()=>[e(C,{link:"",type:"success"},{default:o(()=>[_("重置密码")]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:1},8,["api"]),e(ge,{modelValue:t(i),"onUpdate:modelValue":r[7]||(r[7]=n=>Ie(i)?i.value=n:null),title:t(s).showName,width:"500",draggable:""},{footer:o(()=>[x("span",vt,[e(C,{onClick:r[6]||(r[6]=n=>i.value=!1)},{default:o(()=>[_("取消")]),_:1}),e(C,{type:"warning",onClick:G},{default:o(()=>[_("清空")]),_:1}),e(C,{type:"primary",onClick:P},{default:o(()=>[_(" 提交 ")]),_:1})])]),default:o(()=>[e(ye,{ref_key:"formRef",ref:d,model:t(c),"status-icon":"",rules:t(A),"label-width":"auto",class:"demo-form"},{default:o(()=>[e(k,{label:"用户名",prop:"username"},{default:o(()=>[e(g,{modelValue:t(c).username,"onUpdate:modelValue":r[0]||(r[0]=n=>t(c).username=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(k,{label:"邮箱",prop:"email"},{default:o(()=>[e(g,{modelValue:t(c).email,"onUpdate:modelValue":r[1]||(r[1]=n=>t(c).email=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),t(s).showName=="add"?(v(),w(k,{key:0,label:"密码",prop:"password"},{default:o(()=>[e(g,{modelValue:t(c).password,"onUpdate:modelValue":r[2]||(r[2]=n=>t(c).password=n),autocomplete:"off"},null,8,["modelValue"])]),_:1})):M("",!0),e(k,{label:"头像",prop:"avatar"},{default:o(()=>[e(he,{headers:{authorization:t(y)},"list-type":"picture-card","on-success":n=>(t(c).avatar=n.data,t(d).validateField("avatar")),"on-remove":()=>(t(d).resetFields("avatar"),t(c).avatar=""),action:t(s).uploadUrl,"file-list":t(s).fileList,"onUpdate:fileList":r[3]||(r[3]=n=>t(s).fileList=n),limit:1,accept:"image/*"},{default:o(()=>[e(fe,null,{default:o(()=>[e(t(Ue))]),_:1})]),_:1},8,["headers","on-success","on-remove","action","file-list"])]),_:1}),e(k,{label:"地址",prop:"address"},{default:o(()=>[e(g,{modelValue:t(c).address,"onUpdate:modelValue":r[4]||(r[4]=n=>t(c).address=n),autocomplete:"off"},null,8,["modelValue"])]),_:1}),e(k,{label:"角色",prop:"roleId"},{default:o(()=>[e(_e,{style:{width:"100%"},modelValue:t(c).roleId,"onUpdate:modelValue":r[5]||(r[5]=n=>t(c).roleId=n),placeholder:"请选择"},{default:o(()=>[(v(!0),N(Pe,null,$e(t(h),n=>(v(),w(ve,{key:n.id,label:n.name,value:n.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["modelValue","title"])])}}});export{jt as default};
